/* --- General page style --- */
body {
  /* subtle vertical gradient: slightly lighter at top, darker at bottom */
  background: linear-gradient(to bottom, rgb(20, 5, 20) 0%, rgb(14, 2, 2) 60%, rgba(2,2,2,1) 100%);
  background-attachment: fixed;
  color: #f0f0f0;
  font-family: 'Vani', sans-serif;
  margin: 0;
  overflow: hidden; /* prevent scrollbars since weâ€™ll pan/zoom instead */
}

.page-title {
  text-align: center;
  font-size: 1.8em;
  margin-top: 0.8em;
  color: gold;
}

/* Title panel on the right with rounded background and stats toggle */
.title-panel {
  position: absolute;
  right: 20px;
  top: 8px;
  z-index: 350;
}
.title-inner {
  display: flex;
  flex-direction: column; /* stack title and button */
  align-items: flex-end;  /* right align contents */
  gap: 6px;

  background: rgba(20,20,20,0.85);
  padding: 8px 12px;
  border-radius: 10px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.5);
}
.title-inner .page-title { margin: 0; font-size: 1.55em; text-align: right; }
.stats-toggle {
  background: #222;
  color: gold;
  border: 1px solid #444;
  padding: 6px 10px;
  border-radius: 6px;
  cursor: pointer;
}

/* Character stats popup (resembles hover desc) */
.char-stats-box {
  margin-top: 8px;
  font-family: 'Trebuchet MS';
  background: rgba(0,0,0,0.95);
  border: 1px solid gold;
  padding: 10px;
  border-radius: 6px;
  width: 260px;
  color: #fff;
}
.char-stats-box h3 { margin: 0 0 8px 0; font-size: 1em; color: gold; }
.char-stats-box .stat-row { margin: 6px 0; }
.char-stats-box .stat-label { color: #ccc; }
.char-stats-box .stat-value { color: #fff; font-weight: 600; }

.char-stats-box .dice-sub { margin-left: 8px; color: #ddd; font-size: 0.95em; }
.char-stats-box .dice-sub div { margin: 4px 0; padding-left: 8px; }

/* persistent hover box that appears on click */
.persist-desc-box {
  position: fixed;
  left: 12px;
  top: 12px;
   font-family: 'Trebuchet MS';
  z-index: 500;
  background: rgba(0,0,0,0.98);
  border: 2px solid transparent; /* set by JS per skill type */
  padding: 10px 12px 12px 12px;
  border-radius: 8px;
  color: #fff;
  width: 340px;
  box-shadow: 0 8px 30px rgba(0,0,0,0.6);
}
.persist-desc-box .persist-close {
  position: absolute;
   font-family: 'Trebuchet MS';
  right: 8px;
  top: 6px;
  width: 26px;
  height: 26px;
  border-radius: 50%;
  border: none;
  background: rgba(180,0,0,0.95);
  color: white;
  font-weight: 700;
  cursor: pointer;
}
.persist-desc-box .persist-content { margin-top: 6px; }
.persist-desc-box { cursor: grab; }
.persist-desc-box.dragging { cursor: grabbing; opacity: 0.98; }

/* Custom alert modal */
.app-alert { position: fixed; left: 0; top: 0; width: 100%; height: 100%; z-index: 900; display: flex; align-items: center; justify-content: center; }
.app-alert-backdrop { position: absolute; left:0; top:0; right:0; bottom:0; background: rgba(0,0,0,0.7); }
.app-alert-box { position: relative; background: rgba(12,12,12,0.98); border: 2px solid gold; padding: 18px; border-radius: 10px; width: 360px; max-width: 90%; box-shadow: 0 10px 40px rgba(0,0,0,0.6); color: #fff; z-index: 910; }
.app-alert-content { margin-bottom: 12px; }
.app-alert-topclose { position: absolute; right: 8px; top: 8px; width: 28px; height: 28px; border-radius: 50%; background: rgba(180,0,0,0.95); color: white; border: none; font-weight: 700; cursor: pointer; }
.app-alert-actions { display:flex; gap:12px; justify-content:center; }
.app-alert-actions button { background: #222; color: gold; border: 1px solid #666; padding: 6px 12px; border-radius: 6px; cursor: pointer; }
.app-alert-actions button:hover { background: #333; }

/* --- Layout for all trees --- */
.tree-wrapper {
  display: flex;
  justify-content: space-around;
  align-items: flex-start;
  height: 80vh;
  margin: 0 auto;
  width: 95vw;
  position: relative;
  transform-origin: 50% 50%;
}

/* --- Individual trees --- */
.tree {
  width: 32%;
  height: 100%;
  position: relative;
  background: transparent;
}

.tree h2 {
  position: absolute;
  bottom: -60px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 3em;
  color: #f9f932;
  font-weight: 700;
  text-align: center;
  /* embossed + drop shadow effect */
  text-shadow: 
    /* drop shadow */
    0 8px 16px rgba(0, 0, 0, 0.9),
    /* embossed highlight (top-left) */
    -1px -1px 3px rgba(255, 255, 206, 0.772),
    /* embossed shadow (bottom-right) */
    2px 3px 6px rgba(36, 39, 8, 0.7);
}

/* --- Tree canvas --- */
.tree-canvas {
  position: relative;
  width: 100%;
  height: 100%;
  overflow: visible;
}

/* --- Nodes --- */
.skill {
  width: 90px;
  height: 90px;
  border-radius: 50%;
  background-color: #222;
  border: 3px solid #777;
  color: #fff;
  position: absolute;
  display: flex;
  font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
  justify-content: center;
  align-items: center;
  text-align: center;
  font-size: 0.8em;
  cursor: pointer;
  transform: translate(-50%, -50%);
  transition: opacity 320ms ease, transform 320ms ease;
  z-index: 2;
}

.skill.offense { border-color: red; }
.skill.defense { border-color: royalblue; }
.skill.shared { border-color: rgb(77, 5, 92); }
.skill.special { border-color: #ff5e00; }

.skill.available { box-shadow: 0 0 12px yellow; 
animation: connector-breathe-skill 8.0s ease-in-out infinite;}

@keyframes connector-breathe-skill {
  0% { box-shadow: 0 0 3px rgba(143, 123, 9, .2); }
  50% { box-shadow: 0 0 15px rgba(255, 217, 0, 0.6); }
  100% { box-shadow: 0 0 3px rgba(143, 123, 9, .2); }
}
.skill.selected {
  background: linear-gradient(180deg, #5f5904, #92941e);
  border-color: rgb(223, 226, 14);
  box-shadow: 0 0 2px rgb(238, 255, 0);
}



/* --- Connectors --- */
.connector {
  position: absolute;
  background: #444;
  height: 4px;
  transform-origin: left center;
  z-index: 1;
  transition: background 0.4s, height 0.4s, opacity 520ms ease;
}

.connector.active {
  background: rgb(204, 224, 17);
  height: 5px;
}

/* connectors that lead to an available (but not yet selected) node */
.connector.available {
  /* keep the connector itself fully visible, but use a dim pulsing outer glow */
  background: rgb(132, 132, 129); /* solid line color so the bar stays visible */
  height: 5px;
  box-shadow: 0 0 10px rgba(255, 215, 0, 0.12);
  animation: connector-breathe 8.0s ease-in-out infinite;
}


@keyframes connector-breathe {
  0% { box-shadow: 0 0 0 rgba(255, 217, 0, 0); }
  50% { box-shadow: 0 0 25px rgba(255, 217, 0, 0.7); }
  100% { box-shadow: 0 0 0 rgba(255, 217, 0, 0); }


  
}

/* --- Controls --- */
.controls {
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  background: rgba(0, 0, 0, 0.986);
  padding: 0;
  box-shadow: 0 15px 45px rgba(117, 2, 2, 0.829), 0 5px 15px rgba(61, 19, 178, 0.872);
  z-index: 9999; /* bring controls above transformed viewport */
  overflow: visible; /* allow drop-up menus to extend outside without creating scrollbars */
  /* responsive font-size that scales down on small viewports */
  font-size: clamp(13px, 1.3vw, 15px);
}

.controls-inner {
  display: flex;
  align-items: center;
  justify-content: space-between;
  font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
  font-size: 1.10em;
  max-width: 100%;
  margin: 0 auto;
  padding: 6px 14px;
  gap: 8px;
  min-height: 38px;
  flex-wrap: nowrap;
  white-space: nowrap;
  overflow-x: auto;
  overflow-y: visible; /* allow drop-up menus to extend above without being clipped */
}

.controls-left, .controls-center, .controls-right {
  display: flex;
  align-items: center;
  gap: 6px;
  flex: 0 0 auto;
  min-width: 0;
}

.controls-right { overflow: visible; }

.controls-center {
  justify-content: center;
  gap: 12px;
  flex: 0 0 auto; /* center area maintains intrinsic width */
}

.controls input[type="number"], .controls input[type="text"] {
  width: 50px;
  padding: 4px 6px;
  border-radius: 4px;
  border: none;
  background: #222;
  color: white;
  box-sizing: border-box;
  flex: 0 0 auto;
  font-size: 1.0em;
}

/* allow number inputs to shrink on very narrow viewports */
.controls input[type="number"] { min-width: 40px; }

/* make character name input flexible so it ends right before center controls */
.controls-left { gap: 4px; }
.controls-left label { margin-right: 0; flex: 0 0 auto; font-size: 0.95em; }
.controls-left input[type="text"] { flex: 0 0 auto; width: 220px; }

.remaining-wrap {
  margin-left: 8px;
  color: gold;
}

/* Random dropdown menu */
.random-dropdown {
  position: relative;
  display: inline-block;
  z-index: 10000; /* ensure the dropdown's positioning context sits above most content */
}

.dropdown-toggle {
  cursor: pointer;
  background: #333;
  border: 1px solid #777;
  color: white;
  font-size: 0.9em;
  margin: 0 4px;
  padding: 4px 8px;
  border-radius: 4px;
}

.dropdown-toggle:hover {
  background: #444;
}

.dropdown-menu {
  position: absolute;
  bottom: 100%;
  left: 0;
  background: rgba(30, 30, 30, 0.98);
  border: 1px solid #666;
  border-radius: 4px;
  z-index: 11000; /* very high so it sits above the viewport and other overlays */
  min-width: 140px;
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.6);
  margin-bottom: 2px;
  pointer-events: auto; /* ensure buttons are clickable */
}

.random-option {
  display: block;
  width: 100%;
  padding: 8px 12px;
  text-align: left;
  background: transparent;
  border: none;
  color: white;
  cursor: pointer;
  font-size: 0.9em;
  transition: background 0.2s ease;
}

.random-option:hover {
  background: rgba(100, 100, 200, 0.3);
}

.random-option:first-child {
  border-radius: 3px 3px 0 0;
}

.random-option:last-child {
  border-radius: 0 0 3px 3px;
}

.controls input, .controls button {
  margin: 0 4px;
  padding: 4px 8px;
  border-radius: 4px;
  border: none;
  background: #222;
  color: white;
  font-size: 0.9em;
}

.controls button {
  cursor: pointer;
  background: #333;
  border: 1px solid #777;
}

.controls button:hover {
  background: #444;
}

/* --- Description box --- */
#desc-box {
  position: fixed;
  bottom: auto;
  left: auto;
  background: rgba(0, 0, 0, 0.95);
  border: 1px solid gold;
  padding: 10px;
  border-radius: 6px;
  width: 300px;
  max-width: 420px;
  max-height: 260px; /* constrain height to avoid huge empty space */
  overflow: auto;
  text-align: left;
  display: none;
  z-index: 650;
  box-sizing: border-box;
  contain: layout paint; /* isolate from document layout */
}

.desc-pin {
  position: absolute;
  left: 8px;
  top: 8px;
  background: transparent;
  border: none;
  color: gold;
  cursor: pointer;
}
.desc-inner { padding-left: 28px; }

/* --- Zoom buttons --- */
#zoom-controls {
  position: fixed;
  /* raise the zoom controls above the bottom controls bar */
  bottom: 70px;
  right: 4px; /* move closer to the edge */
  display: flex;
  flex-direction: column;
  gap: 6px;
  z-index: 400;
}

#zoom-controls .zoom-slider-wrap {
  display: flex;
  justify-content: center;
  margin-bottom: 6px;
}
.zoom-slider {
  width: 10px;
  height: 110px;
  background: rgba(60,60,60,0.9);
  border-radius: 8px;
  position: relative;
  box-shadow: 0 3px 8px rgba(0,0,0,0.6);
}
.zoom-thumb {
  position: absolute;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 18px;
  height: 18px;
  background: gold;
  border-radius: 50%;
  cursor: ns-resize;
  box-shadow: 0 2px 6px rgba(0,0,0,0.6);
}
.zoom-buttons { display:flex; gap:8px; justify-content:center; }
.zoom-btn {
  width: 32px;
  height: 32px;
  font-size: 18px;
  border: none;
  border-radius: 6px;
  background: rgba(40, 40, 40, 0.9);
  color: gold;
  cursor: pointer;
  transition: all 0.12s ease;
}
.zoom-btn:hover { background: rgba(70,70,70,0.9); transform: scale(1.04); }

/* --- Tier dividers and labels --- */
.tier-divider {
  position: absolute;
  /* shift the divider further left across the canvas */
  left: -150px;
  height: 4px;
  width: calc(100% + 500px); 
   z-index: 0;
  background: linear-gradient(to right, transparent 0%, rgba(255, 0, 0, 0.315) 25%, rgba(76, 7, 167, 0.315) 50%, rgba(0, 4, 255, 0.315) 75%, transparent 100%);
   animation: connector-breathe-purple 20.0s ease-in-out infinite;
}

@keyframes connector-breathe-purple {
  0% { box-shadow: 0 0 0 rgba(255, 0, 0, 0); }
  50% { box-shadow: 0 0 45px rgba(99, 0, 94, 0.829); }
  100% { box-shadow: 0 0 0 rgba(4, 0, 255, 0); }
  
}


.tier-label {
  position: absolute;
  left: -100px; /* move label to align with left-shifted dividers */
  transform: none;
  font-size: 1em;
  font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
  color: rgb(255, 255, 255);
  text-shadow: 2px 2px 4px rgba(2,3,3,0.75);
 background: linear-gradient(to bottom, rgba(251, 255, 0, 0.562), rgba(156, 58, 34, 0.2));
  padding: 2px 8px;
  border-radius: 4px;
  text-transform: uppercase;
  letter-spacing: 1px;
  z-index: 1;
  pointer-events: none;
}

/* Pool chooser modal (reuses modal patterns) */
.credits-btn {
  position: fixed;
  left: 12px;
  font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
  bottom: 62px; /* sit above controls bar (adjust if controls height changes) */
  z-index: 800;
  background: linear-gradient(180deg,#222,#111);
  color: gold;
  border: 1px solid #555;
  padding: 8px 12px;
  border-radius: 6px;
  cursor: pointer;
  box-shadow: 0 6px 18px rgba(0,0,0,0.6);
}

/* Floating bouncing words */
.credits-word {
  position: fixed;
  left: 0;
  top: 0;
  font-weight: 800;
  font-size: 28px;
  padding: 6px 10px;
  border-radius: 6px;
  color: white;
  text-shadow: 0 2px 8px rgba(0,0,0,0.6);
  pointer-events: none;
  z-index: 1000;
  user-select: none;
}

.confetti-piece {
  position: fixed;
  width: 8px;
  height: 8px;
  border-radius: 2px;
  z-index: 1200;
  pointer-events: none;
}

.firework-ring {
  position: fixed;
  border-radius: 50%;
  z-index: 1200;
  pointer-events: none;
  mix-blend-mode: screen;
}

.modal { position: fixed; left: 0; top: 0; right: 0; bottom: 0; display:flex; align-items:center; justify-content:center; z-index: 920; }
.modal .modal-content { background: rgba(12,12,12,0.98); border: 2px solid gold; padding: 12px; border-radius: 8px; width: 280px; box-shadow: 0 8px 24px rgba(0,0,0,0.6); color: #fff; text-align: center; }
.modal .modal-content.small { width: 220px; font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif; } 
.modal .modal-close { position: absolute; right: 10px; top: 8px; border: none; background: rgba(180,0,0,0.95); color: white; width: 28px; height: 28px; border-radius: 50%; cursor:pointer; }
.modal-body { margin: 10px 0; display:flex; flex-direction:column; gap:8px; align-items:center; }
.modal-body label { color: #ddd; font-size: 0.95em; }
.modal-body input[type=number] { width: 80px; padding: 6px 8px; border-radius: 6px; border: none; background: #222; color: white; text-align: center; }
.modal-actions { display:flex; justify-content:center; gap:8px; margin-top: 8px; }
.btn { background: #222; color: gold; border: 1px solid #555; padding: 6px 10px; border-radius: 6px; cursor:pointer; }
.btn.primary { background: linear-gradient(90deg,#006600,#00aa00); color: white; border: none; }

